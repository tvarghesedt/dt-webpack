var default_dynamic_var = require("./default_dynamic");

console.log(default_dynamic_var.scroll_amount_for_sticky);

var min_header_height_scroll = default_dynamic_var.min_header_height_scroll;

var header_height = default_dynamic_var.header_height;

var exports = module.exports = {};


var $j = jQuery.noConflict();

var $scroll = 0;

var $window_width = $j(window).width();

var $window_height = $j(window).height();

var logo_height = default_dynamic_var.logo_height;

var menu_dropdown_height_set = false;

var sticky_amount = 0;

var content_menu_position;

var content_menu_top;

var content_menu_top_add = 0;

var src;

var next_image;

var prev_image;

var $top_header_height;

var min_w = 1500;

var video_width_original = 1280;

var video_height_original = 720;

var vid_ratio = 1280 / 720;

//var skrollr_slider;

var paspartu_width;

if (typeof paspartu_width_init == "undefined") {
    var paspartu_width_init = .02;
}

var sticky_animate;

function headerSize($scroll) {
    "use strict";
    if ($j("header.page_header").hasClass("scroll_top") && $j("header.page_header").hasClass("has_top") && ($j("header.page_header").hasClass("fixed") || $j("header.page_header").hasClass("fixed_hiding"))) {
        if ($scroll >= 0 && $scroll <= 34) {
            $j("header.page_header").css("top", -$scroll);
            $j("header.page_header").css("margin-top", 0);
            $j(".header_top").show();
        } else if ($scroll > 34) {
            $j("header.page_header").css("top", "-34px");
            $j("header.page_header").css("margin-top", 34);
            $j(".header_top").hide();
        }
    }
    if (typeof page_scroll_amount_for_sticky !== "undefined") {
        sticky_amount = page_scroll_amount_for_sticky;
    } else if ($j(".carousel.full_screen").length) {
        sticky_amount = $j(".carousel").height();
    } else {
        sticky_amount = default_dynamic_var.scroll_amount_for_sticky;
    }
    if ($j("header").hasClass("regular")) {
        if (header_height - logo_height >= 10) {
            $j(".q_logo a").height(logo_height);
        } else {
            $j(".q_logo a").height(header_height - 10);
        }
        $j(".q_logo a img").css("height", "100%");
    }
    if ($j("header.page_header").hasClass("fixed")) {
        if ($j("header.page_header").hasClass("scroll_top")) {
            $top_header_height = 34;
        } else {
            $top_header_height = 0;
        }
        if (header_height - $scroll + $top_header_height >= min_header_height_scroll && $scroll >= $top_header_height) {
            $j("header.page_header").removeClass("scrolled");
            $j("header:not(.centered_logo.centered_logo_animate) nav.main_menu > ul > li > a").css("line-height", header_height - $scroll + $top_header_height + "px");
            $j("header:not(.centered_logo.centered_logo_animate) .side_menu_button").css("height", header_height - $scroll + $top_header_height + "px");
            $j("header:not(.centered_logo.centered_logo_animate) .shopping_cart_inner").css("height", header_height - $scroll + $top_header_height + "px");
            $j("header:not(.centered_logo.centered_logo_animate) .logo_wrapper").css("height", header_height - $scroll + $top_header_height + "px");
            if (header_height - logo_height > 0) {
                $j("header:not(.centered_logo.centered_logo_animate) .q_logo a").css("height", logo_height + "px");
            } else {
                $j("header:not(.centered_logo.centered_logo_animate) .q_logo a").css("height", header_height - $scroll + $top_header_height - 10 + "px");
            }
        } else if ($scroll < $top_header_height) {
            $j("header.page_header").removeClass("scrolled");
            $j("header:not(.centered_logo.centered_logo_animate) nav.main_menu > ul > li > a").css("line-height", header_height + "px");
            $j("header:not(.centered_logo.centered_logo_animate) .side_menu_button").css("height", header_height + "px");
            $j("header:not(.centered_logo.centered_logo_animate) .shopping_cart_inner").css("height", header_height + "px");
            $j("header:not(.centered_logo.centered_logo_animate) .logo_wrapper").css("height", header_height + "px");
            if (header_height - logo_height > 0) {
                $j("header:not(.centered_logo.centered_logo_animate) .q_logo a").css("height", logo_height + "px");
            } else {
                $j("header:not(.centered_logo.centered_logo_animate) .q_logo a").css("height", header_height - 10 + "px");
            }
        } else if (header_height - $scroll + $top_header_height < min_header_height_scroll) {
            $j("header.page_header").addClass("scrolled");
            $j("header:not(.centered_logo.centered_logo_animate) nav.main_menu > ul > li > a").css("line-height", min_header_height_scroll + "px");
            $j("header:not(.centered_logo.centered_logo_animate) .side_menu_button").css("height", min_header_height_scroll + "px");
            $j("header:not(.centered_logo.centered_logo_animate) .shopping_cart_inner").css("height", min_header_height_scroll + "px");
            $j("header:not(.centered_logo.centered_logo_animate) .logo_wrapper").css("height", min_header_height_scroll + "px");
            if (min_header_height_scroll - logo_height > 0) {
                $j("header:not(.centered_logo.centered_logo_animate) .q_logo a").css("height", logo_height + "px");
            } else {
                $j("header:not(.centered_logo.centered_logo_animate) .q_logo a").css("height", min_header_height_scroll - 10 + "px");
            }
        }
        if ($j("header.page_header").hasClass("centered_logo") && $j("header.page_header").hasClass("centered_logo_animate")) {
            if (header_height - $scroll + $top_header_height < logo_height && header_height - $scroll + $top_header_height >= min_header_height_scroll && logo_height > min_header_height_scroll - 10 && $scroll >= $top_header_height) {
                $j(".q_logo a").height(header_height - $scroll + $top_header_height - 10);
            } else if (header_height - $scroll + $top_header_height < logo_height && header_height - $scroll + $top_header_height >= min_header_height_scroll && logo_height > min_header_height_scroll - 10 && $scroll < $top_header_height) {
                $j(".q_logo a").height(header_height - 10);
            } else if (header_height - $scroll + $top_header_height < logo_height && header_height - $scroll + $top_header_height < min_header_height_scroll && logo_height > min_header_height_scroll - 10) {
                $j(".q_logo a").height(min_header_height_scroll - 10);
            } else if (header_height - $scroll + $top_header_height < logo_height && header_height - $scroll + $top_header_height < min_header_height_scroll && logo_height < min_header_height_scroll - 10) {
                $j(".q_logo a").height(logo_height);
            } else if ($scroll + $top_header_height === 0 && logo_height > header_height - 10) {
                $j(".q_logo a").height(logo_height);
            } else {
                $j(".q_logo a").height(logo_height);
            }
        } else if ($j("header.page_header").hasClass("centered_logo")) {
            $j(".q_logo a").height(logo_height);
            $j(".q_logo img").height("auto");
        } else {
            $j(".q_logo img").height("100%");
        }
    }
    if ($j("header.page_header").hasClass("fixed_hiding")) {
        if ($scroll < scroll_amount_for_fixed_hiding) {
            $j("header.page_header").removeClass("scrolled");
        } else {
            $j("header.page_header").addClass("scrolled");
        }
        $j(".q_logo a").height(logo_height / 2);
        $j(".q_logo img").height("100%");
    }
    if ($j("header.page_header").hasClass("stick") || $j("header.page_header").hasClass("stick_with_left_right_menu")) {
        if ($scroll > sticky_amount) {
            if (!$j("header.page_header").hasClass("sticky")) {
                if ($j("header.page_header").hasClass("has_top")) {
                    $top_header_height = 34;
                } else {
                    $top_header_height = 0;
                }
                var padding_top = $j("header.page_header").hasClass("centered_logo") ? $j("header.page_header").height() : header_height + $top_header_height;
                if ($j("header.page_header").hasClass("menu_bottom")) {
                    padding_top = header_height + 60;
                }
                $j("header.page_header").addClass("sticky");
                $j(".content").css("padding-top", padding_top);
                window.clearTimeout(sticky_animate);
                sticky_animate = window.setTimeout(function() {
                    $j("header.page_header").addClass("sticky_animate");
                }, 100);
                if (min_header_height_sticky - logo_height >= 10) {
                    $j(".q_logo a").height(logo_height);
                } else {
                    $j(".q_logo a").height(min_header_height_sticky - 10);
                }
                if ($j("header.page_header").hasClass("menu_bottom")) {
                    exports.initDropDownMenu();
                }
            }
            if (min_header_height_sticky - logo_height >= 10) {
                $j(".q_logo a").height(logo_height);
            } else {
                $j(".q_logo a").height(min_header_height_sticky - 10);
            }
        } else {
            if ($j("header.page_header").hasClass("sticky")) {
                $j("header").removeClass("sticky_animate");
                $j("header").removeClass("sticky");
                $j(".content").css("padding-top", "0px");
                if ($j("header.page_header").hasClass("menu_bottom")) {
                    exports.initDropDownMenu();
                }
            }
            //setMargingsForLeftAndRightMenu();
            if (!$j("header.page_header").hasClass("centered_logo")) {
                if (header_height - logo_height >= 10) {
                    $j(".q_logo a").height(logo_height);
                } else {
                    $j(".q_logo a").height(header_height - 10);
                }
            } else {
                $j(".q_logo a").height(logo_height);
                $j(".q_logo img").height("auto");
            }
            $j(".q_logo a img").css("height", "100%");
        }
    }
}

function logoSizeOnSmallScreens() {
    "use strict";
    if (100 - 20 < logo_height) {
        $j(".q_logo a").height(100 - 20);
    } else {
        $j(".q_logo a").height(logo_height);
    }
    $j(".q_logo a img").css("height", "100%");
    $j("header.page_header").removeClass("sticky_animate sticky");
    $j(".content").css("padding-top", "0px");
}

exports.contentMinHeight = function() {
    "use strict";
    if ($j("header .header_bottom").length || $j("header .bottom_header").length) {
        if ($j("header .header_bottom").length) {
            var headerColorString = $j("header .header_bottom").css("background-color");
        }
        if ($j("header .bottom_header").length) {
            var headerColorString = $j("header .bottom_header").css("background-color");
        }
        var headerTransparency = headerColorString.substring(headerColorString.indexOf("(") + 1, headerColorString.lastIndexOf(")")).split(/,\s*/)[3];
        var haeder_add = headerTransparency == undefined && !$j("header.page_header").hasClass("transparent") ? $j("header.page_header").height() : 0;
        $j("body .content").css("min-height", $window_height - haeder_add - $j("footer:not(.uncover)").height());
    }
}

exports.contentMinHeightWithPaspartu = function() {
    "use strict";
    if ($j(".paspartu_enabled").length) {
        var content_height;
        var paspartu_final_width_px = 0;
        var paspartu_width_px = $window_width * paspartu_width;
        var footer_height = $j("footer").height();
        if ($j(".disable_footer").length) {
            footer_height = 0;
        }
        if ($j(".vertical_menu_enabled").length) {
            if ($j(".paspartu_top").length && $j(".paspartu_middle_inner").length) {
                paspartu_final_width_px += paspartu_width_px;
            }
        } else {
            if ($j(".paspartu_top").length) {
                paspartu_final_width_px += paspartu_width_px;
            }
        }
        if ($j(".paspartu_bottom").length || !$j(".disable_bottom_paspartu").length) {
            paspartu_final_width_px += paspartu_width_px;
        }
        if ($j(".vertical_menu_enabled").length) {
            content_height = $window_height - paspartu_final_width_px - footer_height;
        } else {
            if ($j("header .header_bottom").length) {
                var headerColorString = $j("header .header_bottom").css("background-color");
            }
            if ($j("header .bottom_header").length) {
                var headerColorString = $j("header .bottom_header").css("background-color");
            }
            var headerTransparency = headerColorString.substring(headerColorString.indexOf("(") + 1, headerColorString.lastIndexOf(")")).split(/,\s*/)[3];
            var header_height = headerTransparency == undefined && !$j("header.page_header").hasClass("transparent") ? $j("header.page_header").height() : 0;
            content_height = $window_height - header_height - paspartu_final_width_px - footer_height;
        }
        if ($j(".content").length) {
            $j(".content").css("min-height", content_height);
        }
    }
}

var default_header_style;

function calculateHeights() {
    if ($j(".portfolio_slides").length) {
        $j(".portfolio_slides").each(function() {
            $j(this).parents(".caroufredsel_wrapper").css({
                height: $j(this).find("li.item").outerHeight() - 3 + "px"
            });
        });
    }
    if ($j(".qode_carousels .slides").length) {
        $j(".qode_carousels .slides").each(function() {
            $j(this).parents(".caroufredsel_wrapper").css({
                height: $j(this).find("li.item").outerHeight() + "px"
            });
        });
    }
    if ($j(".blog_slides").length) {
        $j(".blog_slides").each(function() {
            $j(this).parents(".caroufredsel_wrapper").css({
                height: $j(this).find("li.item").outerHeight() - 3 + "px"
            });
        });
    }
}

function initQodeCarousel() {
    "use strict";
    console.log("initQodeCarousel");
    if ($j(".qode_carousels").length) {
        $j(".qode_carousels").each(function() {
            console.log("initqode");
            var itemWidth = $j(this).parents(".grid_section").length == 1 ? 170 : 315;
            $j(this).find(".slides").carouFredSel({
                circular: true,
                responsive: true,
                scroll: {
                    items: 1,
                    duration: 1e3,
                    pauseOnHover: false
                },
                items: {
                    width: itemWidth,
                    visible: {
                        min: 1,
                        max: 6
                    }
                },
                auto: true,
                mousewheel: false,
                swipe: {
                    onMouse: true,
                    onTouch: true
                },
                onCreate: function(e) {
                    console.log(jQuery(this));
                   jQuery(this).parents(".caroufredsel_wrapper").css({
                    height: jQuery(this).find("li.item").outerHeight() + "px"
                   });     
                }
            }).animate({
                opacity: 1
            }, 1e3);
        });
        calculateHeights();
    }
}

var current_scroll;

exports.setDropDownMenuPosition = function() {
    "use strict";
    var menu_items = $j(".drop_down > ul > li.narrow");
    menu_items.each(function(i) {
        var browser_width = $j(window).width() - 16;
        var boxed_layout = 1150;
        var menu_item_position = $j(menu_items[i]).offset().left;
        var sub_menu_width = $j(menu_items[i]).find(".second .inner ul").width();
        var menu_item_from_left = 0;
        if ($j("body").hasClass("boxed")) {
            menu_item_from_left = boxed_layout - (menu_item_position - (browser_width - boxed_layout) / 2) + 17;
        } else {
            menu_item_from_left = browser_width - menu_item_position + 17;
        }
        var sub_menu_from_left;
        if ($j(menu_items[i]).find("li.sub").length > 0) {
            sub_menu_from_left = menu_item_from_left - sub_menu_width;
        }
        if (menu_item_from_left < sub_menu_width || sub_menu_from_left < sub_menu_width) {
            $j(menu_items[i]).find(".second").addClass("right");
            $j(menu_items[i]).find(".second .inner ul").addClass("right");
        }
    });
}

exports.initDropDownMenu = function() {
    "use strict";
    var menu_items = $j(".drop_down > ul > li");
    menu_items.each(function(i) {
        if ($j(menu_items[i]).find(".second").length > 0) {
            if ($j(menu_items[i]).hasClass("wide")) {
                var dropdown = $j(this).find(".inner > ul");
                var dropdownPadding = parseInt(dropdown.css("padding-left").slice(0, -2)) + parseInt(dropdown.css("padding-right").slice(0, -2));
                if (!$j(this).hasClass("left_position") && !$j(this).hasClass("right_position")) {
                    $j(this).find(".second").css("left", 0);
                }
                var tallest = 0;
                $j(this).find(".second > .inner > ul > li").each(function() {
                    var thisHeight = $j(this).height();
                    if (thisHeight > tallest) {
                        tallest = thisHeight;
                    }
                });
                $j(this).find(".second > .inner > ul > li").height(tallest);
                var row_number;
                if ($j(this).find(".second > .inner > ul > li").length > 5) {
                    row_number = 5;
                } else {
                    row_number = $j(this).find(".second > .inner > ul > li").length;
                }
                var width = row_number * $j(this).find(".second > .inner > ul > li").outerWidth();
                $j(this).find(".second > .inner > ul").width(width);
                if (!$j(this).hasClass("wide_background")) {
                    if (!$j(this).hasClass("left_position") && !$j(this).hasClass("right_position")) {
                        var left_position = ($j(window).width() - 2 * ($j(window).width() - $j(this).find(".second").offset().left)) / 2 + (width + dropdownPadding) / 2;
                        $j(this).find(".second").css("left", -left_position);
                    }
                } else {
                    if (!$j(this).hasClass("left_position") && !$j(this).hasClass("right_position")) {
                        var left_position = $j(this).find(".second").offset().left;
                        $j(this).find(".second").css("left", -left_position);
                        $j(this).find(".second").css("width", $j(window).width());
                    }
                }
            }
            if (!menu_dropdown_height_set) {
                $j(menu_items[i]).data("original_height", $j(menu_items[i]).find(".second").height() + "px");
                $j(menu_items[i]).find(".second").height(0);
            }
            if (navigator.userAgent.match(/(iPod|iPhone|iPad)/)) {
                $j(menu_items[i]).on("touchstart mouseenter", function() {
                    $j(menu_items[i]).find(".second").css({
                        height: $j(menu_items[i]).data("original_height"),
                        overflow: "visible",
                        visibility: "visible",
                        opacity: "1"
                    });
                }).on("mouseleave", function() {
                    $j(menu_items[i]).find(".second").css({
                        height: "0px",
                        overflow: "hidden",
                        visivility: "hidden",
                        opacity: "0"
                    });
                });
            } else {
                var config = {
                    interval: 0,
                    over: function() {
                        setTimeout(function() {
                            $j(menu_items[i]).find(".second").addClass("drop_down_start");
                            $j(menu_items[i]).find(".second").stop().css({
                                height: $j(menu_items[i]).data("original_height")
                            });
                        }, 150);
                    },
                    timeout: 150,
                    out: function() {
                        $j(menu_items[i]).find(".second").stop().css({
                            height: "0px"
                        });
                        $j(menu_items[i]).find(".second").removeClass("drop_down_start");
                    }
                };
                $j(menu_items[i]).hoverIntent(config);
            }
        }
    });
    $j(".drop_down ul li.wide ul li a, .drop_down ul li.narrow ul li a").on("click", function() {
        var $this = $j(this);
        if (!$this.next("ul").length && $this.attr("href") !== "http://#" && $this.attr("href") !== "#" && !$this.hasClass("no_link")) {
            setTimeout(function() {
                $this.mouseleave();
            }, 500);
        }
    });
    menu_dropdown_height_set = true;
}

// exports.initVerticalMenu = function() {
//     "use strict";
//     if ($j(".no-touch .vertical_menu_toggle").length) {
//         var menu_items = $j(".no-touch .vertical_menu_toggle > ul > li");
//         var menu_items_2 = $j(".no-touch .vertical_menu_toggle ul li ul li");
//         menu_items.each(function(i) {
//             if ($j(menu_items[i]).hasClass("has_sub")) {
//                 var subitems_number = $j(menu_items[i]).find(".inner > ul > li").length;
//                 $j(menu_items[i]).hoverIntent({
//                     over: function() {
//                         $j(menu_items[i]).addClass("open");
//                         $j(menu_items[i]).find(".second").slideDown(subitems_number * 40, "easeInOutSine", function() {
//                         });
//                     },
//                     out: function() {
//                         $j(menu_items[i]).removeClass("open");
//                         $j(menu_items[i]).find(".second").slideUp(subitems_number * 40, "easeInOutSine");
//                     },
//                     timeout: 1e3
//                 });
//             }
//         });
//         menu_items_2.each(function(i) {
//             if ($j(menu_items_2[i]).hasClass("menu-item-has-children")) {
//                 var subitems_number = $j(menu_items_2[i]).find("ul > li").length;
//                 $j(menu_items_2[i]).hoverIntent({
//                     over: function() {
//                         $j(menu_items_2[i]).addClass("open");
//                         $j(menu_items_2[i]).find("ul").slideDown(subitems_number * 40, "easeInOutSine", function() {
//                         });
//                     },
//                     out: function() {
//                         $j(menu_items_2[i]).removeClass("open");
//                         $j(menu_items_2[i]).find("ul").slideUp(subitems_number * 40, "easeInOutSine");
//                     },
//                     timeout: 1e3
//                 });
//             }
//         });
//     } else if ($j(".vertical_menu_on_click").length) {
//         var menu_items = $j(".vertical_menu_on_click > ul > li > a");
//         var menu_items_2 = $j(".vertical_menu_on_click ul li ul li a");
//         menu_items.each(function(i) {
//             if ($j(menu_items[i]).parent().hasClass("has_sub")) {
//                 $j(menu_items[i]).on("tap click", function(e) {
//                     e.preventDefault();
//                     if (!$j(this).parent().hasClass("open")) {
//                         $j(".vertical_menu_on_click > ul > li").removeClass("open");
//                         $j(".vertical_menu_on_click > ul > li").find(".second").slideUp("fast");
//                         $j(this).parent().addClass("open");
//                         $j(this).parent().find(".second").slideDown("slow", function() {
//                         });
//                     } else {
//                         $j(this).parent().removeClass("open");
//                         $j(this).parent().find(".second").slideUp("fast", function() {
//                         });
//                     }
//                     return false;
//                 });
//             }
//         });
//         menu_items_2.each(function(i) {
//             if ($j(menu_items_2[i]).parent().hasClass("menu-item-has-children")) {
//                 $j(menu_items_2[i]).on("tap click", function(e) {
//                     e.preventDefault();
//                     if (!$j(this).parent().hasClass("open")) {
//                         $j(".vertical_menu_on_click ul li ul li").removeClass("open");
//                         $j(".vertical_menu_on_click ul li ul li").find("ul").slideUp("fast");
//                         $j(this).parent().addClass("open");
//                         $j(this).parent().find("ul").slideDown("slow", function() {
//                         });
//                     } else {
//                         $j(this).parent().removeClass("open");
//                         $j(this).parent().find("ul").slideUp("fast", function() {
//                         });
//                     }
//                     return false;
//                 });
//             }
//         });
//     } else if ($j(".no-touch .vertical_menu_float").length) {
//         var menu_items = $j(".no-touch .vertical_menu_float > ul > li");
//         var menu_items_2 = $j(".no-touch .vertical_menu_float ul li ul li");
//         menu_items.each(function(i) {
//             if ($j(menu_items[i]).hasClass("has_sub")) {
//                 $j(menu_items[i]).hoverIntent({
//                     over: function() {
//                         $j(menu_items[i]).addClass("open");
//                         $j(menu_items[i]).find(".second").addClass("vertical_menu_start");
//                     },
//                     out: function() {
//                         $j(menu_items[i]).removeClass("open");
//                         $j(menu_items[i]).find(".second").removeClass("vertical_menu_start");
//                     },
//                     timeout: 300
//                 });
//             }
//         });
//         menu_items_2.each(function(i) {
//             if ($j(menu_items_2[i]).hasClass("menu-item-has-children")) {
//                 var subitems_number = $j(menu_items_2[i]).find("ul > li").length;
//                 $j(menu_items_2[i]).hoverIntent({
//                     over: function() {
//                         $j(menu_items_2[i]).addClass("open");
//                         $j(menu_items_2[i]).find("ul").addClass("vertical_submenu_start");
//                     },
//                     out: function() {
//                         $j(menu_items_2[i]).removeClass("open");
//                         $j(menu_items_2[i]).find("ul").removeClass("vertical_submenu_start");
//                     },
//                     timeout: 300
//                 });
//             }
//         });
//     }
// }

var portfolio_width;

(function($) {
    var $window = $(window);
    var windowHeight = $window.height();
    $window.resize(function() {
        windowHeight = $window.height();
    });    
})(jQuery);

function prettyPhoto() {
    "use strict";
    $j("a[data-rel]").each(function() {
        $j(this).attr("rel", $j(this).data("rel"));
    });
    $j("a[rel^='prettyPhoto']").prettyPhoto({
        animation_speed: "normal",
        slideshow: false,
        autoplay_slideshow: false,
        opacity: .8,
        show_title: true,
        allow_resize: true,
        horizontal_padding: 0,
        default_width: 650,
        default_height: 400,
        counter_separator_label: "/",
        theme: "pp_default",
        hideflash: false,
        wmode: "opaque",
        autoplay: true,
        modal: false,
        overlay_gallery: false,
        keyboard_shortcuts: true,
        deeplinking: false,
        social_tools: false
    });
}

function initMobileMenu() {
    "use strict";
    $j(".mobile_menu_button > span").on("tap click", function(e) {
        e.preventDefault();
        if ($j(".mobile_menu > ul").is(":visible")) {
            $j(".mobile_menu > ul").slideUp(200);
        } else {
            $j(".mobile_menu > ul").slideDown(200);
        }
    });
    $j(".mobile_menu > ul > li.has_sub > span.mobile_arrow, .mobile_menu > ul > li.has_sub > h3, .mobile_menu > ul > li.has_sub > a[href*='#']").on("tap click", function(e) {
        e.preventDefault();
        if ($j(this).closest("li.has_sub").find("> ul.sub_menu").is(":visible")) {
            $j(this).closest("li.has_sub").find("> ul.sub_menu").slideUp(200);
            $j(this).closest("li.has_sub").removeClass("open_sub");
        } else {
            $j(this).closest("li.has_sub").addClass("open_sub");
            $j(this).closest("li.has_sub").find("> ul.sub_menu").slideDown(200);
        }
    });
    $j(".mobile_menu > ul > li.has_sub > ul.sub_menu > li.has_sub > span.mobile_arrow, .mobile_menu > ul > li.has_sub > ul.sub_menu > li.has_sub > h3, .mobile_menu > ul > li.has_sub > ul.sub_menu > li.has_sub > a[href*='#']").on("tap click", function(e) {
        e.preventDefault();
        if ($j(this).parent().find("ul.sub_menu").is(":visible")) {
            $j(this).parent().find("ul.sub_menu").slideUp(200);
            $j(this).parent().removeClass("open_sub");
        } else {
            $j(this).parent().addClass("open_sub");
            $j(this).parent().find("ul.sub_menu").slideDown(200);
        }
    });
    $j(".mobile_menu ul li > a, .q_logo a").on("click", function() {
        if ($j(this).attr("href") !== "http://#" && $j(this).attr("href") !== "#") {
            $j(".mobile_menu > ul").slideUp();
        }
    });
}

var $scrollHeight;

function initAccordion() {
    "use strict";
    if ($j(".q_accordion_holder").length) {
        $j(".q_accordion_holder").appear(function() {
            $j(".q_accordion_holder").css("visibility", "visible");
        }, {
            accX: 0,
            accY: -100
        });
        if ($j(".accordion").length) {
            $j(".accordion").accordion({
                animate: "swing",
                collapsible: true,
                active: false,
                icons: "",
                heightStyle: "content",
                activate: function(event, ui) {
                    //initParallax();
                }
            });
            $j(".accordion").each(function() {
                var activeTab = parseInt($j(this).data("active-tab"));
                if (activeTab !== "") {
                    activeTab = activeTab - 1;
                    $j(this).accordion("option", "active", activeTab);
                }
                var borderRadius = parseInt($j(this).data("border-radius"));
                if (borderRadius !== "") {
                    $j(this).find(".accordion_mark").css("border-radius", borderRadius + "px");
                }
                var collapsible = $j(this).data("collapsible") == "yes" ? true : false;
                $j(this).accordion("option", "collapsible", collapsible);
                $j(this).accordion("option", "collapsible", collapsible);
            });
        }
        $j(".toggle").addClass("accordion ui-accordion ui-accordion-icons ui-widget ui-helper-reset").find(".title-holder").addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-top ui-corner-bottom").hover(function() {
            $j(this).toggleClass("ui-state-hover");
        }).click(function() {
            $j(this).toggleClass("ui-accordion-header-active ui-state-active ui-state-default ui-corner-bottom").next().toggleClass("ui-accordion-content-active").slideToggle(400);
            return false;
        }).next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom").hide();
        $j(".toggle").each(function() {
            var activeTab = parseInt($j(this).data("active-tab"));
            if (activeTab !== "" && activeTab >= 1) {
                activeTab = activeTab - 1;
                $j(this).find(".ui-accordion-content").eq(activeTab).show();
                $j(this).find(".ui-accordion-header").eq(activeTab).addClass("ui-state-active");
            }
        });
    }
}

function initAccordionContentLink() {
    "use strict";
    if ($j(".accordion").length) {
        $j(".accordion_holder .accordion_inner .accordion_content a").click(function() {
            if ($j(this).attr("target") === "_blank") {
                window.open($j(this).attr("href"), "_blank");
            } else {
                window.open($j(this).attr("href"), "_self");
            }
            return false;
        });
    }
}

var timeOuts = [];

function totop_button(a) {
    "use strict";
    var b = $j("#back_to_top");
    b.removeClass("off on");
    if (a === "on") {
        b.addClass("on");
    } else {
        b.addClass("off");
    }
}

function backButtonShowHide() {
    "use strict";
    $j(window).scroll(function() {
        var b = $j(this).scrollTop();
        var c = $j(this).height();
        var d;
        if (b > 0) {
            d = b + c / 2;
        } else {
            d = 1;
        }
        if (d < 1e3) {
            totop_button("off");
        } else {
            totop_button("on");
        }
    });
}

function backToTop() {
    "use strict";
    $j(document).on("click", "#back_to_top", function(e) {
        e.preventDefault();
        $j("body,html").animate({
            scrollTop: 0
        }, $j(window).scrollTop() / 3, "linear");
    });
}

function initToCounterVerticalProgressBar($this) {
    "use strict";
    if ($this.find(".progress_number span").length) {
        $this.find(".progress_number span").each(function() {
            var $max = parseFloat($j(this).text());
            $j(this).countTo({
                from: 0,
                to: $max,
                speed: 1500,
                refreshInterval: 50
            });
        });
    }
}

function anchorActiveState(me) {
    if (me.closest(".main_menu").length > 0) {
        $j(".main_menu a").parent().removeClass("active");
    }
    if (me.closest(".vertical_menu").length > 0) {
        $j(".vertical_menu a").parent().removeClass("active");
    }
    if (me.closest(".second").length === 0) {
        me.parent().addClass("active");
    } else {
        me.closest(".second").parent().addClass("active");
    }
    if (me.closest(".mobile_menu").length > 0) {
        $j(".mobile_menu a").parent().removeClass("active");
        me.parent().addClass("active");
    }
    $j(".mobile_menu a, .main_menu a, .vertical_menu a").removeClass("current");
    me.addClass("current");
}

function initCheckSafariBrowser() {
    "use strict";
    if (navigator.userAgent.indexOf("Safari") !== -1 && navigator.userAgent.indexOf("Chrome") === -1) {
        $j("body").addClass("safari_browser");
    }
}

function setContentBottomMargin() {
    if ($j(".uncover").length) {
        $j(".content").css("margin-bottom", $j("footer").height());
    }
}

function getParentBackgroundColor(element) {
    return element.parents().filter(function() {
        var color = $j(this).css("background-color");
        return color != "transparent" && color != "rgba(0, 0, 0, 0)";
    }).eq(0).css("background-color");
}

function checkActiveArrowsOnFullScrrenTemplate(section_number, index) {
    "use strict";
    if (index === 1) {
        $j(".full_screen_navigation_holder #up_fs_button").hide();
        if (index != section_number) {
            $j(".full_screen_navigation_holder #down_fs_button").show();
        }
    } else if (index === section_number) {
        if (section_number === 2) {
            $j(".full_screen_navigation_holder #up_fs_button").show();
        }
        $j(".full_screen_navigation_holder #down_fs_button").hide();
    } else {
        $j(".full_screen_navigation_holder #up_fs_button").show();
        $j(".full_screen_navigation_holder #down_fs_button").show();
    }
}

function checkFullScreenSectionsForHeaderStyle(index, default_header_style) {
    "use strict";
    if ($j("[data-q_header_style]").length > 0 && $j("header").hasClass("header_style_on_scroll")) {
        if ($j($j(".full_screen_holder .full_screen_inner .full_screen_section")[index - 1]).data("q_header_style") !== undefined) {
            var header_style = $j($j(".full_screen_holder .full_screen_inner .full_screen_section")[index - 1]).data("q_header_style");
            $j("header").removeClass("dark light").addClass(header_style);
        } else {
            $j("header").removeClass("dark light").addClass(default_header_style);
        }
    }
}

$j(document).ready(function() {
    "use strict";
    if ($j("header").hasClass("regular")) {
        content_menu_top = 0;
    }
    if ($j("header").hasClass("fixed_top_header")) {
        content_menu_top = header_height;
    }
    if ($j("header").hasClass("fixed")) {
        content_menu_top = min_header_height_scroll;
    }
    if ($j("header").hasClass("fixed_hiding")) {
        content_menu_top = min_header_height_fixed_hidden + 40;
    }
    if ($j("header").hasClass("stick") || $j("header").hasClass("stick_with_left_right_menu")) {
        content_menu_top = 0;
    }
    if (!$j("header.page_header").hasClass("scroll_top") && $j("header.page_header").hasClass("has_top") && $j("header.page_header").hasClass("fixed")) {
        content_menu_top_add = 34;
    }
    if ($j("body").hasClass("vertical_menu_enabled")) {
        content_menu_top = 0;
        content_menu_top_add = 0;
        var min_header_height_sticky = 0;
    }
    paspartu_width = $window_width < 1024 ? .02 : paspartu_width_init;
    exports.contentMinHeight();
    exports.contentMinHeightWithPaspartu();
    exports.setDropDownMenuPosition();
    exports.initDropDownMenu();
//    exports.initVerticalMenu();
    //exports.initVerticalMobileMenu();
    //initQodeSlider();
    //initSideMenu();
    //initPopupMenu();
    //initMessageHeight();
    //initToCounter();
    //
    //initProgressBars();
    //initListAnimation();
    //initServiceAnimation();
    //initParallaxTitle();
    //initSideAreaScroll();
    //initVerticalAreaMenuScroll();
    prettyPhoto();
    //alterWPMLSwitcherHeaderBottom();
    initMobileMenu();
    initAccordion();
    initAccordionContentLink();
    //initMessages();
    //initProgressBarsIcon();
    //initMoreFacts();
    //placeholderReplace();
    backButtonShowHide();
    backToTop();
    //initSteps();
    //showGoogleMap();
    //initProgressBarsVertical();
    //initElementsAnimation();
    //updateShoppingCart();
    //initHashClick();
    // initIconWithTextAnimation();
     initCheckSafariBrowser();
    // initSearchButton();
    // initCoverBoxes();
    // createContentMenu();
    // contentMenuScrollTo();
    // createSelectContentMenu();
    // initButtonHover();
    // initSocialIconHover();
    // initIconShortcodeHover();
    // initIconWithTextHover();
    // parallaxLayers();
    
    $scroll = $j(window).scrollTop();
    // checkTitleToShowOrHide();
    // checkVerticalMenuTransparency();
    if ($j(window).width() > 1e3) {
        headerSize($scroll);
    } else {
        logoSizeOnSmallScreens();
    }
    // if ($j(window).width() > 768) {
    //     contentMenuPosition();
    // }
    //contentMenuCheckLastSection();
    $j("header:not(.stick_with_left_right_menu) .q_logo a").css("visibility", "visible");
    //initFullScreenTemplate();
    //showHideVerticalMenu();
    //initLoadNextPostOnBottom();
});

$j(function() {
    "use strict";
    $j(".touch .main_menu li:has(div.second)").doubleTapToGo();
    //initSmallImageBlogHeight();
    exports.setDropDownMenuPosition();
    exports.initDropDownMenu();
    // initPortfolio();
    // initPortfolioZIndex();
    // initPortfolioSingleInfo();
    //initTestimonials();
    //initTabs();
    //countClientsPerRow();
    //animatedTextIconHeight();
    //countAnimatedTextIconPerRow();
    //initTitleAreaAnimation();
    //setContentBottomMargin();
    //footerWidth();
    // if ($j("nav.content_menu").length > 0) {
    //     content_menu_position = $j("nav.content_menu").offset().top;
    //     contentMenuPosition();
    // }
    //contentMenuCheckLastSection();
    initQodeCarousel();
    //initPortfolioSlider();
    //initBlogSlider();
    //initTabsActiveBorder();
    //setActiveTabBorder();
    //initImageHover();
    $j("header.stick_with_left_right_menu .q_logo a").css("visibility", "visible");
    //setMargingsForLeftAndRightMenu();
    //initImageGallerySliderNoSpace();
    //initVerticalSplitSlider();
    //initParallax();
    // setTimeout(function() {
    //     checkAnchorOnScroll();
    //     checkAnchorOnLoad();
    //     checkHeaderStyleOnScroll();
    // }, 700);
});

$j(window).scroll(function() {
    "use strict";
    $scroll = $j(window).scrollTop();
    if ($j(window).width() > 1e3) {
        headerSize($scroll);
    }
    // if ($j(window).width() > 768) {
    //     contentMenuPosition();
    // }
    //contentMenuCheckLastSection();
    //checkVerticalMenuTransparency();
    $j(".touch .drop_down > ul > li").mouseleave();
    $j(".touch .drop_down > ul > li").blur();
});

$j(window).resize(function() {
    "use strict";
    $window_width = $j(window).width();
    $window_height = $j(window).height();
    paspartu_width = $window_width < 1024 ? .02 : paspartu_width_init;
    if ($j(window).width() > 1e3) {
        headerSize($scroll);
    } else {
        logoSizeOnSmallScreens();
    }
    //initMessageHeight();
    //initTestimonials();
    //initSmallImageBlogHeight();
    //animatedTextIconHeight();
    //countAnimatedTextIconPerRow();
    //countClientsPerRow();
    //setContentBottomMargin();
    //footerWidth();
    calculateHeights();
    $j(".vertical_split_slider").height($window_height);    
    exports.contentMinHeight();
    exports.contentMinHeightWithPaspartu();
});
jQuery(window).bind("load", function() {
    //jQuery( ".qode_carousels_holder .item img" ).each(function( index ) {
     jQuery(".qode_carousels_holder .item img").lazy({delay:0, bind: "event",afterLoad: function() {console.log("all executed");
      if (jQuery(".qode_carousels .slides").length) {
            jQuery(".qode_carousels .slides").each(function() {
                jQuery(this).parents(".caroufredsel_wrapper").css({
                    height: jQuery(this).find("li.item").outerHeight() + "px"
                });
            });
        }}});
   // });
});

// module.exports = {
//     contentMinHeight: contentMinHeight,
//     contentMinHeightWithPaspartu: contentMinHeight,
//     setDropDownMenuPosition: setDropDownMenuPosition
// };